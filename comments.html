<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Comments Keeper</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #commentsList { margin-top: 20px; }
    .comment { border-bottom: 1px solid #ccc; padding: 5px 0; }
  </style>
</head>
<body>

<h1>Comments Keeper</h1>

<form id="commentForm">
  <input type="text" id="name" placeholder="Your name" required /><br><br>
  <textarea id="message" placeholder="Your comment" required></textarea><br><br>
  <button type="submit">Post Comment</button>
</form>

<div id="commentsList"></div>

<!-- Firebase SDK -->
<script type="module">
  // 1️⃣ Import Firebase SDK modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.15.0/firebase-app.js";
  import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/10.15.0/firebase-firestore.js";

  // 2️⃣ Your Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyCQe5qYatB7icH1yoYyZ9590ag80F5Flos",
    authDomain: "comments-keeper.firebaseapp.com",
    projectId: "comments-keeper",
    storageBucket: "comments-keeper.firebasestorage.app",
    messagingSenderId: "171557062392",
    appId: "1:171557062392:web:cc718e4b5de112e4f2dd0d"
  };

  // 3️⃣ Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);
  const commentsCollection = collection(db, "Comments");

  // 4️⃣ Functions to post and load comments
  async function postComment(name, message) {
    try {
      await addDoc(commentsCollection, {
        name: name,
        message: message,
        timestamp: new Date()
      });
      console.log("Comment posted!");
    } catch (e) {
      console.error("Error posting comment:", e);
    }
  }

  async function loadComments() {
    const commentsDiv = document.getElementById("commentsList");
    commentsDiv.innerHTML = "";
    const q = query(commentsCollection, orderBy("timestamp", "desc"));
    const querySnapshot = await getDocs(q);

    querySnapshot.forEach((doc) => {
      const data = doc.data();
      const div = document.createElement("div");
      div.className = "comment";
      div.textContent = `${data.name}: ${data.message}`;
      commentsDiv.appendChild(div);
    });
  }

  // Form submission
  document.getElementById("commentForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const name = document.getElementById("name").value;
    const message = document.getElementById("message").value;
    await postComment(name, message);
    document.getElementById("name").value = "";
    document.getElementById("message").value = "";
    await loadComments();
  });

  // Load comments on page load
  loadComments();
</script>

</body>
</html>
